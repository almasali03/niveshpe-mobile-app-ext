<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Funds v2 - NiveshPe</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- V2 CSS -->
    <link rel="stylesheet" href="assets/css/my-funds-v2.css">

    <!-- Chart.js for donut chart -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <link rel="stylesheet" href="assets/css/iphone-toggle.css">
</head>
<body>
    <!-- Frame Toggle Button -->
    <button class="frame-toggle-btn" id="frameToggleBtn" onclick="toggleFrameMode()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M17,19H7V5H17M17,1H7C5.89,1 5,1.89 5,3V21A2,2 0 0,0 7,23H17A2,2 0 0,0 19,21V3C19,1.89 18.1,1 17,1Z"/>
        </svg>
        <span id="frameToggleText">Normal View</span>
    </button>


    <div class="iphone-frame">
        <!-- iPhone Notch (Dynamic Island style) -->
        <div class="iphone-notch"></div>


        <div class="iphone-screen">
            <div class="mobile-container">
                <!-- Status Bar -->
                <div class="status-bar">
                    <div>9:41</div>
                    <div class="status-icons">
                        <span>â€¢â€¢â€¢</span>
                        <span>ðŸ“¶</span>
                        <span>ðŸ”‹</span>
                    </div>
                </div>

                <!-- Header -->
                <div class="header">
                    <div class="header-spacer"></div>
                    <div class="header-title">My Funds</div>
                    <div class="header-actions">
                        <button class="icon-btn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Sticky Mini Header -->
                <div class="sticky-header" id="stickyHeader">
                    <div class="sticky-value">
                        <span class="sticky-label">Current Value</span>
                        <span class="sticky-amount">â‚¹2,37,500</span>
                    </div>
                </div>

                <!-- Scrollable Content -->
                <div class="scroll-content">
                    <div class="parallax-container">
                        <!-- Portfolio Summary Background Layer -->
                        <div class="portfolio-background">
                            <div class="portfolio-summary">
                                <div class="portfolio-value">
                                    <div class="value-label">Current Value</div>
                                    <div class="value-amount">â‚¹2,37,500</div>
                                    <div class="value-returns">
                                        <span class="returns-amount">+â‚¹52,700</span>
                                        <span class="returns-percentage">
                                            <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                                                <path d="M7 14l5-5 5 5z"/>
                                            </svg>
                                            28.5%
                                        </span>
                                    </div>
                                </div>

                                <div class="portfolio-metrics">
                                    <div class="metric-card">
                                        <span class="metric-label">Invested:</span>
                                        <span class="metric-value">â‚¹1,84,800</span>
                                    </div>
                                    <div class="metric-card">
                                        <span class="metric-label">XIRR:</span>
                                        <span class="metric-value">27.8%</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Enhanced Glassmorphism Actions -->
                            <div class="portfolio-actions">
                                <button class="btn btn-withdraw" onclick="window.location.href='withdraw-funds-step1-overlay.html'">
                                    <div class="btn-content">
                                        <span class="btn-text">Withdraw</span>
                                    </div>
                                </button>
                                <button class="btn btn-invest" onclick="window.location.href='add-funds.html?directInvest=true'">
                                    <div class="btn-content">
                                        <span class="btn-icon">
                                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                                            </svg>
                                        </span>
                                        <span class="btn-text">Invest More</span>
                                    </div>
                                </button>
                            </div>
                        </div>

                        <!-- Scrollable Overlay Content -->
                        <div class="scroll-overlay">

                    <!-- Tabs Section -->
                    <div class="tabs-container">
                        <div class="tabs-nav">
                            <button class="tab-btn active">Holdings</button>
                            <button class="tab-btn">Active SIPs</button>
                            <button class="tab-btn">Goals</button>
                        </div>
                    </div>

                    <!-- Tab Content -->
                    <div id="holdings-tab" class="tab-content active">
                        <!-- NEW: Asset Allocation Overview (Inside Holdings Tab) -->
                        <div id="asset-allocation-section" class="asset-allocation-section">
                            <div class="allocation-header">
                                <h3 class="allocation-title">Asset Allocation</h3>
                                <a href="portfolio-allocation.html" class="view-all-link">View â€º</a>
                            </div>

                            <!-- 4-Column Grid View -->
                            <div class="asset-allocation-grid">
                                <div class="asset-item">
                                    <div class="asset-percentage equity-color">80%</div>
                                    <div class="asset-label">Equity</div>
                                </div>
                                <div class="asset-item">
                                    <div class="asset-percentage debt-color">15%</div>
                                    <div class="asset-label">Debt</div>
                                </div>
                                <div class="asset-item">
                                    <div class="asset-percentage commodity-color">0%</div>
                                    <div class="asset-label">Commodity</div>
                                </div>
                                <div class="asset-item">
                                    <div class="asset-percentage others-color">5%</div>
                                    <div class="asset-label">Others</div>
                                </div>
                            </div>
                        </div>

                        <!-- Asset Allocation Skeleton (shown during load) -->
                        <div id="asset-allocation-skeleton" class="asset-allocation-skeleton" style="display: none;">
                            <div class="asset-allocation-skeleton-header skeleton"></div>
                            <div class="asset-allocation-skeleton-grid">
                                <div class="asset-skeleton-item">
                                    <div class="asset-skeleton-percentage skeleton"></div>
                                    <div class="asset-skeleton-label skeleton"></div>
                                </div>
                                <div class="asset-skeleton-item">
                                    <div class="asset-skeleton-percentage skeleton"></div>
                                    <div class="asset-skeleton-label skeleton"></div>
                                </div>
                                <div class="asset-skeleton-item">
                                    <div class="asset-skeleton-percentage skeleton"></div>
                                    <div class="asset-skeleton-label skeleton"></div>
                                </div>
                                <div class="asset-skeleton-item">
                                    <div class="asset-skeleton-percentage skeleton"></div>
                                    <div class="asset-skeleton-label skeleton"></div>
                                </div>
                            </div>
                        </div>

                        <!-- NEW: Sort & Filter Controls (Inside Holdings Tab) -->
                        <div class="sort-filter-section">
                            <div class="sort-control">
                                <label for="sortSelect">Sort by:</label>
                                <select id="sortSelect" class="sort-dropdown" onchange="sortHoldings(this.value)">
                                    <option value="current-value">Current Value</option>
                                    <option value="returns">Returns %</option>
                                    <option value="invested">Invested Amount</option>
                                    <option value="alphabetical">Alphabetical</option>
                                </select>
                            </div>
                        </div>

                        <!-- Holdings List -->
                        <div class="holdings-list" id="holdingsList">
                            <!-- Holdings cards will be generated by JavaScript -->
                        </div>

                        <!-- Holdings Skeletons (shown during load) -->
                        <div id="holdings-skeleton-container" style="display: none;">
                            <!-- Skeleton Card 1 -->
                            <div class="holdings-skeleton-card">
                                <div class="holdings-skeleton-header">
                                    <div class="holdings-skeleton-name skeleton"></div>
                                    <div class="holdings-skeleton-arrow skeleton"></div>
                                </div>
                                <div class="holdings-skeleton-type skeleton"></div>
                                <div class="holdings-skeleton-row">
                                    <div class="holdings-skeleton-item">
                                        <div class="holdings-skeleton-label skeleton"></div>
                                        <div class="holdings-skeleton-value skeleton"></div>
                                    </div>
                                    <div class="holdings-skeleton-item">
                                        <div class="holdings-skeleton-label skeleton"></div>
                                        <div class="holdings-skeleton-value skeleton"></div>
                                    </div>
                                    <div class="holdings-skeleton-item">
                                        <div class="holdings-skeleton-label skeleton"></div>
                                        <div class="holdings-skeleton-value skeleton"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Skeleton Card 2 -->
                            <div class="holdings-skeleton-card">
                                <div class="holdings-skeleton-header">
                                    <div class="holdings-skeleton-name skeleton"></div>
                                    <div class="holdings-skeleton-arrow skeleton"></div>
                                </div>
                                <div class="holdings-skeleton-type skeleton"></div>
                                <div class="holdings-skeleton-row">
                                    <div class="holdings-skeleton-item">
                                        <div class="holdings-skeleton-label skeleton"></div>
                                        <div class="holdings-skeleton-value skeleton"></div>
                                    </div>
                                    <div class="holdings-skeleton-item">
                                        <div class="holdings-skeleton-label skeleton"></div>
                                        <div class="holdings-skeleton-value skeleton"></div>
                                    </div>
                                    <div class="holdings-skeleton-item">
                                        <div class="holdings-skeleton-label skeleton"></div>
                                        <div class="holdings-skeleton-value skeleton"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Skeleton Card 3 -->
                            <div class="holdings-skeleton-card">
                                <div class="holdings-skeleton-header">
                                    <div class="holdings-skeleton-name skeleton"></div>
                                    <div class="holdings-skeleton-arrow skeleton"></div>
                                </div>
                                <div class="holdings-skeleton-type skeleton"></div>
                                <div class="holdings-skeleton-row">
                                    <div class="holdings-skeleton-item">
                                        <div class="holdings-skeleton-label skeleton"></div>
                                        <div class="holdings-skeleton-value skeleton"></div>
                                    </div>
                                    <div class="holdings-skeleton-item">
                                        <div class="holdings-skeleton-label skeleton"></div>
                                        <div class="holdings-skeleton-value skeleton"></div>
                                    </div>
                                    <div class="holdings-skeleton-item">
                                        <div class="holdings-skeleton-label skeleton"></div>
                                        <div class="holdings-skeleton-value skeleton"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="sips-tab" class="tab-content">
                        <div class="sip-list">
                            <!-- SIP 1 -->
                            <div class="sip-card">
                                <div class="sip-status"></div>
                                <div class="sip-amount">â‚¹10,000</div>
                                <div class="sip-frequency">Monthly SIP</div>
                                <div class="sip-next">
                                    <svg viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"/>
                                    </svg>
                                    Next debit on 25th Nov
                                </div>
                                <div class="sip-funds">
                                    Investing in 3 funds: Axis Midcap, SBI Small Cap, HDFC Liquid
                                </div>
                                <div class="sip-actions">
                                    <button class="sip-action-btn">Edit</button>
                                    <button class="sip-action-btn">Pause</button>
                                    <button class="sip-action-btn">Stop</button>
                                </div>
                            </div>

                            <!-- SIP 2 -->
                            <div class="sip-card">
                                <div class="sip-status"></div>
                                <div class="sip-amount">â‚¹5,000</div>
                                <div class="sip-frequency">Weekly SIP</div>
                                <div class="sip-next">
                                    <svg viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"/>
                                    </svg>
                                    Every Monday
                                </div>
                                <div class="sip-funds">
                                    Investing in HDFC Liquid Fund
                                </div>
                                <div class="sip-actions">
                                    <button class="sip-action-btn">Edit</button>
                                    <button class="sip-action-btn">Pause</button>
                                    <button class="sip-action-btn">Stop</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="goals-tab" class="tab-content">
                        <div class="goals-list">
                            <!-- Goal 1 -->
                            <div class="goals-card">
                                <div class="goals-header">
                                    <div class="goals-icon">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"/>
                                        </svg>
                                    </div>
                                    <div class="goals-info">
                                        <div class="goals-name">Dream Home</div>
                                        <div class="goals-target">Target: â‚¹15,00,000</div>
                                    </div>
                                </div>
                                <div class="goals-amounts">
                                    <div class="goals-achieved">â‚¹5,25,000 achieved</div>
                                    <div class="goals-percentage">35%</div>
                                </div>
                                <div class="goals-progress">
                                    <div class="goals-progress-bar">
                                        <div class="goals-progress-fill on-track" style="width: 35%;"></div>
                                    </div>
                                </div>
                                <div class="goals-footer">
                                    <div class="goals-status on-track">On track</div>
                                    <div class="goals-timeline">3.5 years remaining</div>
                                </div>
                            </div>

                            <!-- Goal 2 -->
                            <div class="goals-card">
                                <div class="goals-header">
                                    <div class="goals-icon">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,7C13.4,7 14.8,8.6 14.8,10V11.5C15.4,11.5 16,12.1 16,12.7V16.2C16,16.8 15.4,17.3 14.8,17.3H9.2C8.6,17.3 8,16.8 8,16.2V12.8C8,12.2 8.6,11.6 9.2,11.6V10C9.2,8.6 10.6,7 12,7M12,8.2C11.2,8.2 10.5,8.7 10.5,9.5V11.5H13.5V9.5C13.5,8.7 12.8,8.2 12,8.2Z"/>
                                        </svg>
                                    </div>
                                    <div class="goals-info">
                                        <div class="goals-name">Child Education</div>
                                        <div class="goals-target">Target: â‚¹25,00,000</div>
                                    </div>
                                </div>
                                <div class="goals-amounts">
                                    <div class="goals-achieved">â‚¹3,75,000 achieved</div>
                                    <div class="goals-percentage">15%</div>
                                </div>
                                <div class="goals-progress">
                                    <div class="goals-progress-bar">
                                        <div class="goals-progress-fill on-track" style="width: 15%;"></div>
                                    </div>
                                </div>
                                <div class="goals-footer">
                                    <div class="goals-status on-track">On track</div>
                                    <div class="goals-timeline">8 years remaining</div>
                                </div>
                            </div>

                            <!-- Goal 3 -->
                            <div class="goals-card">
                                <div class="goals-header">
                                    <div class="goals-icon">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M5,11L6.5,6.5H17.5L19,11M17.5,16A1.5,1.5 0 0,1 16,14.5A1.5,1.5 0 0,1 17.5,13A1.5,1.5 0 0,1 19,14.5A1.5,1.5 0 0,1 17.5,16M6.5,16A1.5,1.5 0 0,1 5,14.5A1.5,1.5 0 0,1 6.5,13A1.5,1.5 0 0,1 8,14.5A1.5,1.5 0 0,1 6.5,16M18.92,6C18.72,5.42 18.16,5 17.5,5H6.5C5.84,5 5.28,5.42 5.08,6L3,12V20A1,1 0 0,0 4,21H5A1,1 0 0,0 6,20V19H18V20A1,1 0 0,0 19,21H20A1,1 0 0,0 21,20V12L18.92,6Z"/>
                                        </svg>
                                    </div>
                                    <div class="goals-info">
                                        <div class="goals-name">New Car</div>
                                        <div class="goals-target">Target: â‚¹8,00,000</div>
                                    </div>
                                </div>
                                <div class="goals-amounts">
                                    <div class="goals-achieved">â‚¹4,80,000 achieved</div>
                                    <div class="goals-percentage">60%</div>
                                </div>
                                <div class="goals-progress">
                                    <div class="goals-progress-bar">
                                        <div class="goals-progress-fill behind" style="width: 60%;"></div>
                                    </div>
                                </div>
                                <div class="goals-footer">
                                    <div class="goals-status behind">Behind schedule</div>
                                    <div class="goals-timeline">1 year remaining</div>
                                </div>
                            </div>
                        </div>
                    </div>

                        </div>
                    </div>
                </div>

                <!-- Enhanced Bottom Navigation -->
                <nav class="bottom-nav">
                    <a href="index.html" class="nav-item">
                        <div class="nav-icon">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                            </svg>
                        </div>
                        <span class="nav-label">Home</span>
                    </a>
                    <a href="my-funds.html" class="nav-item active">
                        <div class="nav-icon">
                            <svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M21.0273 13.375C21.3789 13.375 21.6602 13.6914 21.5898 14.0078C21.3438 15.9766 20.3945 17.6992 19.0234 18.9648C18.8125 19.1758 18.4609 19.1758 18.25 18.9648L12.6953 13.375H21.0273ZM20.4648 11.125C20.5 11.4414 20.2188 11.6875 19.9023 11.6875H12.0625V3.84766C12.0625 3.53125 12.3086 3.25 12.625 3.28516C16.8438 3.56641 20.1836 6.90625 20.4648 11.125ZM10.375 13.375L15.8242 18.8594C16.0703 19.1055 16.0703 19.5273 15.7891 19.7031C14.4531 20.6875 12.8008 21.25 11.043 21.25C6.50781 21.3203 2.64062 17.6289 2.5 13.1289C2.32422 8.73438 5.52344 5.07812 9.74219 4.48047C10.0586 4.44531 10.375 4.72656 10.375 5.04297V13.375Z" fill="currentColor"/>
                            </svg>
                        </div>
                        <span class="nav-label">My Funds</span>
                    </a>
                    <a href="mutual-funds.html" class="nav-item">
                        <div class="nav-icon">
                            <svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12.5 20V10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M18.5 20V4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M6.5 20V16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </div>
                        <span class="nav-label">Mutual Funds</span>
                    </a>
                    <a href="transaction-history.html" class="nav-item">
                        <div class="nav-icon">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M16.2,16.2L11,13V7H12.5V12.2L17,14.9L16.2,16.2Z"/>
                            </svg>
                        </div>
                        <span class="nav-label">History</span>
                    </a>
                </nav>

                <!-- Investor Profile Overlay -->
                <div id="investorProfileOverlay" class="investor-overlay hidden" onclick="closeInvestorProfile()">
                    <!-- Page 1: Quick Investor Snapshot -->
                    <div id="profilePage1" class="profile-page active" onclick="event.stopPropagation()">
                        <!-- Drag Handle -->
                        <div class="profile-drag-handle">
                            <div class="profile-drag-bar"></div>
                        </div>

                        <!-- Close Button -->
                        <button class="profile-close-btn" onclick="closeInvestorProfile()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                            </svg>
                        </button>

                        <!-- Modal Header -->
                        <div class="profile-modal-header">
                            <h2 class="profile-modal-title">Let's personalize your investments</h2>
                            <p class="profile-modal-subtitle">Quick setup to find your perfect funds</p>
                        </div>

                        <!-- Content Area -->
                        <div class="profile-content-area">
                            <div class="profile-questions">
                                <!-- Monthly Income -->
                                <div class="question-block">
                                    <h3 class="question-title">Your Monthly Income</h3>
                                    <div class="chips-container">
                                        <button class="chip" data-income="<25K">â‚¹ <25K</button>
                                        <button class="chip" data-income="25K-50K">â‚¹25Kâ€“50K</button>
                                        <button class="chip" data-income="50K-1L">â‚¹50Kâ€“1L</button>
                                        <button class="chip" data-income="1L+">â‚¹1L+</button>
                                    </div>
                                </div>

                                <!-- Investment Duration -->
                                <div class="question-block">
                                    <h3 class="question-title">How long will you stay invested?</h3>
                                    <div class="chips-container">
                                        <button class="chip" data-duration="<6m"><6m</button>
                                        <button class="chip" data-duration="6m-1y">6mâ€“1y</button>
                                        <button class="chip" data-duration="1-3y">1â€“3y</button>
                                        <button class="chip" data-duration="3y+">3y+</button>
                                    </div>
                                </div>

                                <!-- Goal -->
                                <div class="question-block">
                                    <h3 class="question-title">Goal</h3>
                                    <div class="goal-container">
                                        <button class="goal-chip" data-goal="wealth">
                                            <span class="goal-icon">â‚¹</span>
                                            <span class="goal-text">Wealth</span>
                                        </button>
                                        <button class="goal-chip" data-goal="emergency">
                                            <span class="goal-icon">
                                                <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                                                    <path d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,7C13.4,7 14.8,8.6 14.8,10V11.5C15.4,11.5 16,12.1 16,12.7V16.2C16,16.8 15.4,17.3 14.8,17.3H9.2C8.6,17.3 8,16.8 8,16.2V12.8C8,12.2 8.6,11.6 9.2,11.6V10C9.2,8.6 10.6,7 12,7M12,8.2C11.2,8.2 10.5,8.7 10.5,9.5V11.5H13.5V9.5C13.5,8.7 12.8,8.2 12,8.2Z"/>
                                                </svg>
                                            </span>
                                            <span class="goal-text">Emergency</span>
                                        </button>
                                        <button class="goal-chip" data-goal="growth">
                                            <span class="goal-icon">
                                                <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                                                    <path d="M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L19.71,9.71L22,12V6H16Z"/>
                                                </svg>
                                            </span>
                                            <span class="goal-text">Retirement</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Continue Section -->
                        <div class="profile-continue-section">
                            <button class="profile-continue-btn" id="continueBtn" onclick="showRiskAssessment()">
                                <span>Continue</span>
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
                                </svg>
                            </button>
                            <button class="profile-skip-btn" onclick="skipToDefaultFunds()">
                                Skip and invest in default funds
                            </button>
                        </div>
                    </div>

                    <!-- Page 2: Risk Assessment Modal -->
                    <div id="riskAssessment" class="risk-modal hidden" onclick="event.stopPropagation()">
                        <div class="risk-content">
                            <h2 class="risk-heading">Your risk appetite</h2>
                            <h3 class="risk-title">If your â‚¹1,00,000 drops to â‚¹80,000 in 3 months, what would you do?</h3>
                            <div class="risk-options">
                                <button class="risk-option" data-risk="conservative" onclick="selectRiskOption('conservative')">
                                    <span class="risk-main-text">Withdraw it</span>
                                    <span class="risk-sub-text">Get your funds out before it drops more</span>
                                </button>
                                <button class="risk-option" data-risk="moderate" onclick="selectRiskOption('moderate')">
                                    <span class="risk-main-text">Wait & hold</span>
                                    <span class="risk-sub-text">Be patient and wait for the market to recover</span>
                                </button>
                                <button class="risk-option" data-risk="aggressive" onclick="selectRiskOption('aggressive')">
                                    <span class="risk-main-text">Invest more</span>
                                    <span class="risk-sub-text">Buy the dip for better gains in future</span>
                                </button>
                            </div>

                            <!-- Risk Assessment CTAs -->
                            <div class="risk-ctas">
                                <button class="risk-primary-btn" id="seeMyPlanBtn" onclick="proceedWithRiskAssessment()" style="opacity: 0.5; pointer-events: none;">
                                    See My Plan
                                </button>
                                <button class="risk-skip-btn" onclick="skipToDefaultFunds()">
                                    Skip & Invest in default funds
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Loading Screen -->
                    <div id="loadingScreen" class="loading-screen hidden" onclick="event.stopPropagation()">
                        <div class="loading-content">
                            <!-- Progress Text -->
                            <div class="progress-text-container">
                                <h3 class="progress-text" id="progressText">
                                    Finding your ideal plan<span class="loading-dots"><span>â€¢</span><span>â€¢</span><span>â€¢</span></span>
                                </h3>
                            </div>

                            <!-- Ready Text (Hidden initially) -->
                            <div class="ready-text" id="readyText" style="display: none;">
                                <h3>Ready! âœ¨</h3>
                            </div>

                            <!-- Skeleton Loader Structure -->
                            <div class="skeleton-container">
                                <!-- Fund Header Skeleton -->
                                <div class="skeleton-header">
                                    <div class="skeleton-circle"></div>
                                    <div class="skeleton-text-group">
                                        <div class="skeleton-bar skeleton-title"></div>
                                        <div class="skeleton-bar skeleton-subtitle"></div>
                                    </div>
                                </div>

                                <!-- Stats Skeleton -->
                                <div class="skeleton-stats">
                                    <div class="skeleton-stat-box"></div>
                                    <div class="skeleton-stat-box"></div>
                                </div>

                                <!-- Features Skeleton -->
                                <div class="skeleton-features">
                                    <div class="skeleton-feature-row">
                                        <div class="skeleton-feature-circle"></div>
                                        <div class="skeleton-feature-bar"></div>
                                    </div>
                                    <div class="skeleton-feature-row">
                                        <div class="skeleton-feature-circle"></div>
                                        <div class="skeleton-feature-bar"></div>
                                    </div>
                                    <div class="skeleton-feature-row">
                                        <div class="skeleton-feature-circle"></div>
                                        <div class="skeleton-feature-bar"></div>
                                    </div>
                                    <div class="skeleton-feature-row">
                                        <div class="skeleton-feature-circle"></div>
                                        <div class="skeleton-feature-bar"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Page 3: Recommended Funds -->
                    <div id="recommendedFunds" class="profile-page hidden" onclick="event.stopPropagation()">
                        <!-- Drag Handle -->
                        <div class="profile-drag-handle">
                            <div class="profile-drag-bar"></div>
                        </div>

                        <!-- Close Button -->
                        <button class="profile-close-btn" onclick="closeInvestorProfile()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                            </svg>
                        </button>

                        <!-- Modal Header -->
                        <div class="profile-modal-header">
                            <h2 class="profile-modal-title">Recommended Funds</h2>
                            <p class="profile-modal-subtitle">Based on your risk appetite and goals</p>
                        </div>

                        <!-- Content Area -->
                        <div class="profile-content-area">
                            <div class="recommended-funds" id="fundsList">
                                <!-- Funds will be populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Investment CTAs -->
                        <div class="investment-ctas">
                            <button class="investment-primary-btn" onclick="startSIP()">
                                Start SIP
                            </button>
                            <button class="investment-secondary-btn" onclick="oneTimeInvestment()">
                                One time investment
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- iPhone Home Indicator -->
        <div class="iphone-home-indicator"></div>
    </div>

    <script>
        // Investor Profile Overlay System
        let profileData = {
            income: null,
            duration: null,
            goal: null,
            risk: null
        };

        function openInvestorProfile() {
            const overlay = document.getElementById('investorProfileOverlay');

            // Reset everything first
            hideAllPages();
            resetPage1();

            // Show page 1 specifically
            document.getElementById('profilePage1').classList.remove('hidden');
            document.getElementById('profilePage1').classList.add('active');

            // Show the overlay
            overlay.classList.remove('hidden');
            document.body.style.overflow = 'hidden';

            console.log('Investor profile opened - showing page 1');
        }

        function closeInvestorProfile() {
            const overlay = document.getElementById('investorProfileOverlay');
            overlay.classList.add('hidden');
            document.body.style.overflow = 'auto';

            // Reset all states
            profileData = { income: null, duration: null, goal: null, risk: null };
            resetPage1();
            hideAllPages();
            document.getElementById('profilePage1').classList.add('active');
        }

        function resetPage1() {
            // Remove selected states from all chips
            document.querySelectorAll('.chip, .goal-chip').forEach(chip => {
                chip.classList.remove('selected');
            });

            // Disable continue button
            document.getElementById('continueBtn').classList.remove('enabled');
        }

        function hideAllPages() {
            console.log('Hiding all pages');
            document.querySelectorAll('.profile-page, .risk-modal, .loading-screen').forEach(page => {
                console.log('Hiding page:', page.id);
                page.classList.add('hidden');
                page.classList.remove('active');
            });
        }

        // Chip selection handlers
        document.addEventListener('DOMContentLoaded', function() {
            // Income chips
            document.querySelectorAll('[data-income]').forEach(chip => {
                chip.addEventListener('click', function() {
                    // Remove selected from all income chips
                    document.querySelectorAll('[data-income]').forEach(c => c.classList.remove('selected'));
                    // Select this chip
                    this.classList.add('selected');
                    profileData.income = this.dataset.income;
                    checkContinueButton();
                });
            });

            // Duration chips
            document.querySelectorAll('[data-duration]').forEach(chip => {
                chip.addEventListener('click', function() {
                    // Remove selected from all duration chips
                    document.querySelectorAll('[data-duration]').forEach(c => c.classList.remove('selected'));
                    // Select this chip
                    this.classList.add('selected');
                    profileData.duration = this.dataset.duration;
                    checkContinueButton();
                });
            });

            // Goal chips
            document.querySelectorAll('[data-goal]').forEach(chip => {
                chip.addEventListener('click', function() {
                    const goalValue = this.dataset.goal;

                    // Handle "Other" goal specially
                    if (goalValue === 'other') {
                        // Don't remove selected state if already in input mode
                        if (!this.classList.contains('input-mode')) {
                            // Remove selected from all other goal chips
                            document.querySelectorAll('[data-goal]:not([data-goal="other"])').forEach(c => c.classList.remove('selected'));

                            // Switch to input mode
                            this.classList.add('selected', 'input-mode');

                            // Show colon and input (keep "Other" text visible)
                            const otherColon = document.getElementById('otherGoalColon');
                            const otherInput = document.getElementById('otherGoalInput');

                            otherColon.style.display = 'inline';
                            otherInput.style.display = 'inline';

                            // Focus the input
                            setTimeout(() => {
                                otherInput.focus();
                            }, 100);
                        }

                        profileData.goal = goalValue;
                    } else {
                        // Regular goal selection
                        // Remove selected from all goal chips and reset "Other" chip
                        document.querySelectorAll('[data-goal]').forEach(c => {
                            c.classList.remove('selected');
                            if (c.dataset.goal === 'other') {
                                c.classList.remove('input-mode');
                                document.getElementById('otherGoalColon').style.display = 'none';
                                document.getElementById('otherGoalInput').style.display = 'none';
                                document.getElementById('otherGoalInput').value = '';
                            }
                        });

                        // Select this chip
                        this.classList.add('selected');
                        profileData.goal = goalValue;
                        profileData.customGoal = null;
                    }

                    checkContinueButton();
                });
            });

        });

        function checkContinueButton() {
            const continueBtn = document.getElementById('continueBtn');
            let isValid = profileData.income && profileData.duration && profileData.goal;

            // If "Other" is selected, also check if custom goal is entered
            if (profileData.goal === 'other') {
                isValid = isValid && profileData.customGoal && profileData.customGoal.length > 0;
            }

            if (isValid) {
                continueBtn.classList.add('enabled');
            } else {
                continueBtn.classList.remove('enabled');
            }
        }

        function showRiskAssessment() {
            console.log('Showing risk assessment');
            hideAllPages();

            // Reset risk assessment state
            resetRiskAssessment();

            const riskModal = document.getElementById('riskAssessment');
            riskModal.classList.remove('hidden');
            riskModal.classList.add('active');

            setTimeout(() => {
                riskModal.classList.add('active');
            }, 50);
        }

        function resetRiskAssessment() {
            // Clear any previous risk selection
            profileData.risk = null;

            // Reset all risk options to default state
            document.querySelectorAll('.risk-option').forEach(option => {
                option.style.borderColor = 'var(--color-border)';
                option.style.background = 'white';
            });

            // Disable "See My Plan" button
            const seeMyPlanBtn = document.getElementById('seeMyPlanBtn');
            if (seeMyPlanBtn) {
                seeMyPlanBtn.style.opacity = '0.5';
                seeMyPlanBtn.style.pointerEvents = 'none';
            }
        }

        function selectRiskOption(riskLevel) {
            console.log('Risk selected:', riskLevel);
            profileData.risk = riskLevel;

            // Remove selection from all risk options first
            document.querySelectorAll('.risk-option').forEach(option => {
                option.style.borderColor = 'var(--color-border)';
                option.style.background = 'white';
            });

            // Highlight selected option
            event.currentTarget.style.borderColor = 'var(--color-blue)';
            event.currentTarget.style.background = 'rgba(37, 99, 235, 0.05)';

            // Enable the "See My Plan" button only after selection
            const seeMyPlanBtn = document.getElementById('seeMyPlanBtn');
            seeMyPlanBtn.style.opacity = '1';
            seeMyPlanBtn.style.pointerEvents = 'auto';
        }

        function proceedWithRiskAssessment() {
            if (!profileData.risk) return;

            console.log('Proceeding with risk assessment');

            // Show loading screen with animation
            hideAllPages();
            const loadingScreen = document.getElementById('loadingScreen');
            loadingScreen.classList.remove('hidden');
            loadingScreen.classList.add('active');

            // Start typewriter animation
            startTypewriterAnimation();

            // Total duration: 3.5 seconds
            setTimeout(() => {
                console.log('Loading complete, showing recommendations');
                showRecommendedFunds();
            }, 3500);
        }

        function startTypewriterAnimation() {
            const progressText = document.getElementById('progressText');
            const readyText = document.getElementById('readyText');

            // Reset elements - show progress text initially
            if (progressText) {
                progressText.style.display = 'block';
            }
            if (readyText) {
                readyText.style.display = 'none';
            }

            // After 3 seconds, transition to "Ready! âœ¨"
            setTimeout(() => {
                if (progressText) {
                    progressText.style.display = 'none';
                }
                if (readyText) {
                    readyText.style.display = 'block';
                }
            }, 3000);
        }

        function showRecommendedFunds() {
            console.log('Showing recommended funds');
            hideAllPages();
            generateFundRecommendations();

            const recommendedPage = document.getElementById('recommendedFunds');
            recommendedPage.classList.remove('hidden');
            recommendedPage.classList.add('active');

            console.log('Recommended funds page should now be visible');
        }

        function generateFundRecommendations() {
            const fundsList = document.getElementById('fundsList');

            // Default Balanced Returns Fund for all risk profiles
            const balancedFund = {
                name: 'Balanced Returns Fund',
                type: 'Hybrid Fund â€“ Dynamic Asset / Balanced Advantage',
                returns: '10â€“13% p.a.',
                holding: '8+ months',
                features: [
                    {
                        icon: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="9" fill="none"></circle><path d="m9 12 2 2 4-4" stroke-linecap="round" stroke-linejoin="round"></path></svg>',
                        text: 'Balanced Growth + Safety',
                        desc: 'Mix of stocks & bonds for stable returns',
                        color: 'rgba(16, 185, 129, 0.1)',
                        iconColor: 'var(--color-green)'
                    },
                    {
                        icon: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="9" fill="none"></circle><path d="m9 12 2 2 4-4" stroke-linecap="round" stroke-linejoin="round"></path></svg>',
                        text: 'Less Ups & Downs',
                        desc: 'Smooth experience even when markets fluctuate',
                        color: 'rgba(16, 185, 129, 0.1)',
                        iconColor: 'var(--color-green)'
                    },
                    {
                        icon: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="9" fill="none"></circle><path d="m9 12 2 2 4-4" stroke-linecap="round" stroke-linejoin="round"></path></svg>',
                        text: 'Flexible Access',
                        desc: 'Withdraw anytime after 8 months',
                        color: 'rgba(16, 185, 129, 0.1)',
                        iconColor: 'var(--color-green)'
                    },
                    {
                        icon: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="9" fill="none"></circle><path d="m9 12 2 2 4-4" stroke-linecap="round" stroke-linejoin="round"></path></svg>',
                        text: 'Best for:',
                        desc: 'Short-term goals like festivals, gadgets, or emergencies',
                        color: 'rgba(16, 185, 129, 0.1)',
                        iconColor: 'var(--color-green)'
                    }
                ]
            };

            // Generate HTML for the fund card
            fundsList.innerHTML = `
                <div class="balanced-fund-card">
                    <!-- Fund Header -->
                    <div class="fund-card-header">
                        <div class="fund-icon">
                            <svg width="24" height="24" viewBox="0 0 32 32" fill="currentColor">
                                <path d="M29.898,16h-0.454L25.55,8.99C25.802,8.964,26,8.759,26,8.5C26,8.224,25.776,8,25.5,8h-9V7.929
                                    C17.361,7.706,18,6.931,18,6c0-1.105-0.895-2-2-2s-2,0.895-2,2c0,0.931,0.639,1.706,1.5,1.929V8h-9C6.224,8,6,8.224,6,8.5
                                    c0,0.259,0.198,0.464,0.45,0.49L2.556,16H2.102c-0.612,0-1.108,0.551-0.991,1.152C1.648,19.914,4.08,22,7,22s5.352-2.086,5.89-4.848
                                    C13.006,16.551,12.511,16,11.898,16h-0.454L7.556,9h7.394l-0.9,18H10.5c-0.276,0-0.5,0.224-0.5,0.5s0.224,0.5,0.5,0.5h11
                                    c0.276,0,0.5-0.224,0.5-0.5S21.776,27,21.5,27h-3.55l-0.9-18h7.394l-3.889,7h-0.454c-0.612,0-1.108,0.551-0.991,1.152
                                    C19.648,19.914,22.08,22,25,22s5.352-2.086,5.89-4.848C31.006,16.551,30.511,16,29.898,16z M10.3,16H3.7L7,10.059L10.3,16z M15,6
                                    c0-0.551,0.449-1,1-1s1,0.449,1,1s-0.449,1-1,1S15,6.551,15,6z M25,10.059L28.3,16H21.7L25,10.059z"/>
                            </svg>
                        </div>
                        <div class="fund-title-section">
                            <h3 class="fund-card-title">${balancedFund.name}</h3>
                            <p class="fund-card-subtitle">${balancedFund.type}</p>
                        </div>
                    </div>

                    <!-- Fund Stats -->
                    <div class="fund-stats-grid">
                        <div class="stat-item">
                            <div class="stat-icon">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M22,21H2V3H4V19H6V10H10V19H12V6H16V19H18V14H22V21Z"/>
                                </svg>
                            </div>
                            <div class="stat-info">
                                <span class="stat-label">Returns</span>
                                <span class="stat-value">${balancedFund.returns}</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-icon">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M16.2,16.2L11,13V7H12.5V12.2L17,14.9L16.2,16.2Z"/>
                                </svg>
                            </div>
                            <div class="stat-info">
                                <span class="stat-label">Duration</span>
                                <span class="stat-value">${balancedFund.holding}</span>
                            </div>
                        </div>
                    </div>

                    <!-- Fund Features -->
                    <div class="fund-features">
                        ${balancedFund.features.map(feature => `
                            <div class="feature-item">
                                <div class="feature-icon" style="color: ${feature.iconColor};">
                                    ${feature.icon}
                                </div>
                                <div class="feature-content">
                                    <span class="feature-title">${feature.text}</span>
                                    <span class="feature-desc">${feature.desc}</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function startInvesting() {
            // Close overlay and navigate to investment flow
            closeInvestorProfile();

            // You can redirect to a specific investment page or show a success message
            setTimeout(() => {
                window.location.href = 'add-funds.html';
            }, 300);
        }

        function startSIP() {
            // Navigate to SIP setup flow
            closeInvestorProfile();
            setTimeout(() => {
                window.location.href = 'add-funds.html?type=sip';
            }, 300);
        }

        function oneTimeInvestment() {
            // Navigate to one-time investment flow
            closeInvestorProfile();
            setTimeout(() => {
                window.location.href = 'add-funds.html?type=lumpsum';
            }, 300);
        }

        function skipToDefaultFunds() {
            console.log('Skip to default funds clicked');

            // Close overlay and show a default fund recommendation
            closeInvestorProfile();

            // Navigate to add-funds page with default recommendations
            setTimeout(() => {
                window.location.href = 'add-funds.html?default=true';
            }, 300);
        }

    </script>
    <!-- Load funds data v2 -->
    <script src="funds-data-v2.js"></script>
    <!-- Load v2 JavaScript -->
    <script src="assets/js/my-funds-v2.js"></script>
    <script src="assets/js/iphone-toggle.js"></script>
</body>
</html>
